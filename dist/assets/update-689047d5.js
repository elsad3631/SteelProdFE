import{g as V}from"./assets-2a66e18f.js";import{D}from"./Dropdown3-467b18f6.js";import{K as q}from"./NewCardModal-563106ef.js";import{P as z,a as R,C as U,I as E,E as P,L as $,b as G,S as L}from"./Statement-2e550b54.js";import{j as T,u as j,ao as F,r as d,o as O,a3 as Q,an as S,_ as x,n as m,p as e,am as K,W as c,a0 as v,aj as _,F as w,q as A,x as B,O as W,m as u,w as N}from"./index-ac5572e4.js";import{e as k,a as H}from"./goodsReceipt-3e128f38.js";import{g as J}from"./accessories-831a26ee.js";import{g as X}from"./materials-757cb655.js";import{g as Y}from"./profiles-ab9c58bb.js";import{g as Z}from"./suppliers-17d934fd.js";import{S as p}from"./sweetalert2-e92a9e07.js";import"./dom-668969a5.js";import"./index.esm-4ca12020.js";import"./KTDataTable-b34f43d4.js";const ee=T({name:"good-receipt-details",components:{PaymentRecords:z,PaymentMethods:R,CreditBalance:U,Invoices:E,Events:P,Logs:$,Earnings:G,Statement:L,Dropdown3:D,NewCardModal:q},setup(){const t=j(),s=F(),g=t.params.id;let n=d(!0);const a=d(k);let b=d([]),o=d([]),y=d([]),C=d([]),f=d([]),h=d(0);async function M(){C.value=await Z("");const l=await H(g);a.value=l||k,h.value=a.value.typeId,await I(a.value.typeId,null),n.value=!1}O(()=>{n.value=!0,M()}),Q(h,async(l,i)=>{a.value.typeId=l,f.value=[],await I(l,i)});async function I(l,i){l==0&&i!=0?(b.value=await J(""),f.value=b.value.map(r=>({id:r.id,name:r.name}))):l==1&&i!=1?(y.value=await Y(""),f.value=y.value.map(r=>({id:r.id,name:r.name}))):l==2&&i!=2&&(o.value=await X(""),f.value=o.value.map(r=>({id:r.id,name:r.name})))}return{getAssetPath:V,item:a,saveChanges:()=>{var l;if(n.value=!0,a.value.supplierId===0){p.fire({text:"Attenzione, selezionare il fornitore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(a.value.goodId===0){p.fire({text:"Attenzione, selezionare il lotto.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}a.value.goodName=((l=f.value.find(i=>i.id===a.value.goodId))==null?void 0:l.name)||"",S.post("GoodReceipt/Update",a.value).then(()=>{setTimeout(()=>{n.value=!1,p.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})},2e3)}).catch(({response:i})=>{console.log(i.data.message),n.value=!1,p.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})})},GoodsList:f,typeId:h,Suppliers:C,deleteItem:()=>{n.value=!0,S.post(`GoodReceipt/Delete?id=${g}`,{}).then(()=>{setTimeout(()=>{n.value=!1,p.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})},1e3),s.push({name:"goods-receipt-list"})}).catch(({response:l})=>{console.log(l)})},loading:n}}}),oe=e("div",{class:"card mb-5 mb-xl-10"},[e("div",{class:"card-header border-0"},[e("div",{class:"card-title m-0"},[e("h3",{class:"fw-bold m-0"},"Dettagli")])])],-1),te={class:"collapse show"},se={class:"card-body border-top p-9"},le={class:"row mb-6"},ae=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"Numero documento",-1),ne={class:"col-lg-8 fv-row"},ie={class:"row mb-6"},re=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"Data",-1),de={class:"col-lg-8 fv-row"},me={class:"row mb-6"},ce=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"Tipologia",-1),ue={class:"col-lg-8 fv-row"},fe=e("option",{value:"0"},"Accessorio",-1),pe=e("option",{value:"1"},"Profilo",-1),ve=e("option",{value:"2"},"Materiale",-1),ge=[fe,pe,ve],be={class:"row mb-6"},he=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"Lotto",-1),_e={class:"col-lg-8 fv-row"},we=["value"],ye={class:"row mb-6"},Ce=e("label",{class:"col-lg-4 col-form-label fw-semobold fs-6"},"Quantità",-1),Ie={class:"col-lg-8 fv-row"},Se={class:"row mb-6"},Ae=e("label",{class:"col-lg-4 col-form-label required fw-semobold fs-6"},"Fornitore",-1),Be={class:"col-lg-8 fv-row"},Ne=["value"],ke={class:"row mb-6"},Me=e("label",{class:"col-lg-4 col-form-label fw-semobold fs-6"},[e("span",null,"Descrizione")],-1),Ve={class:"col-lg-8 fv-row"},De={class:"card-footer d-flex justify-content-end py-6 px-9"},qe=["data-kt-indicator"],ze={key:0,class:"indicator-label"},Re={key:1,class:"indicator-progress"},Ue=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function Ee(t,s,g,n,a,b){return u(),m(w,null,[oe,e("div",te,[e("form",{class:"form",novalidate:"",onSubmit:s[8]||(s[8]=K(o=>t.saveChanges(),["prevent"]))},[e("div",se,[e("div",le,[ae,e("div",ne,[c(e("input",{type:"text",name:"DocumentNumber",class:"form-control form-control-lg",placeholder:"Nome","onUpdate:modelValue":s[0]||(s[0]=o=>t.item.documentNumber=o)},null,512),[[v,t.item.documentNumber]])])]),e("div",ie,[re,e("div",de,[c(e("input",{type:"date",name:"date",class:"form-control form-control-lg","onUpdate:modelValue":s[1]||(s[1]=o=>t.item.date=o)},null,512),[[v,t.item.date]])])]),e("div",me,[ce,e("div",ue,[c(e("select",{as:"select",class:"form-select form-select-lg fw-semobold","onUpdate:modelValue":s[2]||(s[2]=o=>t.typeId=o)},ge,512),[[_,t.typeId]])])]),e("div",be,[he,e("div",_e,[c(e("select",{as:"select",class:"form-select form-select-lg fw-semobold","onUpdate:modelValue":s[3]||(s[3]=o=>t.item.goodId=o)},[(u(!0),m(w,null,A(t.GoodsList,o=>(u(),m("option",{key:o.id,value:o.id},N(o.name),9,we))),128))],512),[[_,t.item.goodId]])])]),e("div",ye,[Ce,e("div",Ie,[c(e("input",{type:"number",name:"Quantity",class:"form-control form-control-lg",placeholder:"Quantità","onUpdate:modelValue":s[4]||(s[4]=o=>t.item.quantity=o)},null,512),[[v,t.item.quantity]])])]),e("div",Se,[Ae,e("div",Be,[c(e("select",{as:"select",name:"supplier",class:"form-select form-select-lg fw-semobold","onUpdate:modelValue":s[5]||(s[5]=o=>t.item.supplierId=o)},[(u(!0),m(w,null,A(t.Suppliers,o=>(u(),m("option",{key:o.id,value:o.id},N(o.name),9,Ne))),128))],512),[[_,t.item.supplierId]])])]),e("div",ke,[Me,e("div",Ve,[c(e("textarea",{name:"note",class:"form-control form-control-lg","onUpdate:modelValue":s[6]||(s[6]=o=>t.item.note=o)},null,512),[[v,t.item.note]])])])]),e("div",De,[e("button",{type:"button",onClick:s[7]||(s[7]=o=>t.deleteItem()),class:"btn btn-danger btn-active-light-primary me-2"}," Elimina "),e("button",{"data-kt-indicator":t.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[t.loading?B("",!0):(u(),m("span",ze," Salva modifiche ")),t.loading?(u(),m("span",Re,[W(" Attendere... "),Ue])):B("",!0)],8,qe)])],32)])],64)}const Ze=x(ee,[["render",Ee]]);export{Ze as default};
