import{g as I}from"./assets-2a66e18f.js";import{D as F,L as O}from"./KTDataTable-b34f43d4.js";import{S as g}from"./sweetalert2-e92a9e07.js";import{a as q}from"./alphabet-a5bbf61c.js";import{j as P,r,an as E,_ as B,l as S,m as n,n as i,p as e,B as f,z as w,W as m,F as k,q as T,w as y,aj as x,O as b,x as A,am as M,o as V,a0 as h,M as R}from"./index-ac5572e4.js";import{h as j}from"./dom-668969a5.js";import{g as K}from"./profileTypes-8897968e.js";import{g as W}from"./suppliers-17d934fd.js";import{g as Q}from"./DeliveryTypes-4fbe9e42.js";import{a as G}from"./index-68cf51a8.js";import{g as H}from"./profiles-ab9c58bb.js";const Z=P({name:"export-profiles-modal",components:{},setup(){const o=r(null),a=r(!1),d=r({Filter:"",fromName:"A",toName:"Z",exportFormat:"excel"}),_=r({});return{formData:d,rules:_,submit:()=>{o.value&&o.value.validate(c=>{if(c){a.value=!0;let l=r(""),u=r("");if(d.value.exportFormat=="excel")l.value="ExportExcel",u.value=".xlsx";else if(d.value.exportFormat=="csv")l.value="ExportCsv",u.value=".csv";else{g.fire({text:"Attenzione, selezionare il formato del file.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),a.value=!1;return}E.get(`Profiles/${l.value}?fromName=${d.value.fromName}&toName=${d.value.toName}`,"blob").then(t=>{const $=URL.createObjectURL(new Blob([t.data])),v=document.createElement("a");v.href=$,v.setAttribute("download","export profili"+u.value),document.body.appendChild(v),v.click(),window.URL.revokeObjectURL($),document.body.removeChild(v),a.value=!1,g.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})}).catch(({response:t})=>{console.log(t),a.value=!1,g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})})}else return g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})},formRef:o,loading:a,getAssetPath:I,alphabet:q}}});const J={class:"modal fade",id:"kt_export_modal",tabindex:"-1","aria-hidden":"true"},X={class:"modal-dialog modal-dialog-centered mw-650px"},Y={class:"modal-content"},ee={class:"modal-header"},oe=e("h2",{class:"fw-bold"},"Export Profili",-1),te={id:"kt_export_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},ae={class:"modal-body scroll-y mx-5 mx-xl-15 my-7"},se={class:"fv-row mb-10"},le=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il range da lettera a lettera:",-1),ne={class:"input-group mb-5"},ie=["value"],re=e("span",{class:"input-group-text"},"-",-1),de=["value"],ce={class:"fv-row mb-10"},me=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il formato:",-1),ue=e("option",{value:"excel"},"Excel",-1),fe=e("option",{value:"csv"},"CSV",-1),pe=[ue,fe],be={class:"text-center"},ve=e("button",{type:"reset",id:"kt_export_cancel",class:"btn btn-light me-3"}," Scarta ",-1),_e=["data-kt-indicator"],he={key:0,class:"indicator-label"},ge={key:1,class:"indicator-progress"},ye=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function $e(o,a,d,_,p,c){const l=S("KTIcon"),u=S("el-form");return n(),i("div",J,[e("div",X,[e("div",Y,[e("div",ee,[oe,e("div",te,[f(l,{"icon-name":"cross","icon-class":"fs-1"})])]),e("div",ae,[f(u,{onSubmit:a[3]||(a[3]=M(t=>o.submit(),["prevent"])),model:o.formData,rules:o.rules,ref:"formRef"},{default:w(()=>[e("div",se,[le,e("div",ne,[m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[0]||(a[0]=t=>o.formData.fromName=t)},[(n(!0),i(k,null,T(o.alphabet,t=>(n(),i("option",{key:t.name,value:t.name},y(t.name),9,ie))),128))],512),[[x,o.formData.fromName]]),re,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[1]||(a[1]=t=>o.formData.toName=t)},[(n(!0),i(k,null,T(o.alphabet,t=>(n(),i("option",{key:t.name,value:t.name},y(t.name),9,de))),128))],512),[[x,o.formData.toName]])])]),e("div",ce,[me,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[2]||(a[2]=t=>o.formData.exportFormat=t)},pe,512),[[x,o.formData.exportFormat]])]),e("div",be,[ve,e("button",{"data-kt-indicator":o.loading?"on":null,type:"submit",class:"btn btn-lg btn-primary"},[o.loading?A("",!0):(n(),i("span",he,[b(" Invia "),f(l,{"icon-name":"arrow-right","icon-class":"fs-3 ms-2 me-0"})])),o.loading?(n(),i("span",ge,[b(" Attendere... "),ye])):A("",!0)],8,_e)])]),_:1},8,["model","rules"])])])])])}const we=B(Z,[["render",$e]]),Se=P({name:"add-profile-modal",components:{},setup(o,{emit:a}){const d=r(null),_=r(null),p=r(!1),c=r({ProfileType:"",ProfileTypeId:0,Code:"",SupplierArticleCode:"",Name:"",Description:"",UnitOfMeasure:"",Supplier:"",SupplierId:0,Price:0,PackageQuantity:0,MinimumStock:0,DeliveryTimeframe:"",DeliveryType:"",DeliveryTypeId:0}),l=r({name:[{required:!0,message:"Inserire il nome",trigger:"change"}],Code:[{required:!0,message:"Inserire il codice",trigger:"change"}],ProfileType:[{required:!0,message:"Selezionare la tipologia dell'accessorio",trigger:"change"}],Supplier:[{required:!0,message:"Selezionare il fornitore",trigger:"change"}]}),u="Profiles";let t=r([]),$=r([]),v=r([]);async function s(){try{t.value=await K(""),$.value=await W(""),v.value=await Q("")}catch(z){console.error(z)}}return V(()=>{s()}),{formData:c,rules:l,submit:()=>{const z=t.value.find(D=>D.name===c.value.ProfileType),N=$.value.find(D=>D.name===c.value.Supplier),U=v.value.find(D=>D.name===c.value.DeliveryType);if(d.value){if(z===void 0){g.fire({text:"Attenzione, selezionare la tipologia del profilo.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(N===void 0){g.fire({text:"Attenzione, selezionare il fornitore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(U===void 0){g.fire({text:"Attenzione, selezionare il metodo di pagamento.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}c.value.ProfileTypeId=z.id,c.value.SupplierId=N.id,c.value.DeliveryTypeId=U.id,d.value.validate(D=>{if(D)p.value=!0,console.log(c.value),E.post(`${u}/Create`,c.value).then(()=>{p.value=!1,g.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{j(_.value)}),a("formAddSubmitted",c.value)}).catch(({response:L})=>{console.log(L),p.value=!1,g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})});else return p.value=!1,g.fire({text:"Attenzione, non tutti i campi sono corretti.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})}},formRef:d,loading:p,addCustomerModalRef:_,getAssetPath:I,ProfileTypes:t,Suppliers:$,DeliveryTypes:v}}}),De={class:"modal fade",id:"kt_modal_add",ref:"addCustomerModalRef",tabindex:"-1","aria-hidden":"true"},ke={class:"modal-dialog modal-dialog-centered mw-650px"},xe={class:"modal-content"},Ce={class:"modal-header",id:"kt_modal_add_header"},Te=e("h2",{class:"fw-bold"},"Aggiungi profilo",-1),ze={id:"kt_modal_add_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},Ae={class:"modal-body py-10 px-lg-17"},Ie={class:"scroll-y me-n7 pe-7",id:"kt_modal_add_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_header","data-kt-scroll-wrappers":"#kt_modal_add_scroll","data-kt-scroll-offset":"300px"},Pe={class:"fv-row mb-7"},Ee=e("label",{class:"required fs-6 fw-semobold mb-2"},"Codice",-1),Be={class:"fv-row mb-7"},Ne=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Codice articolo fornitore")],-1),Ue={class:"fv-row mb-7"},Me=e("label",{class:"required fs-6 fw-semobold mb-2"},"Nome",-1),Ve={class:"fv-row mb-7"},Le=e("label",{class:"fs-6 fw-semobold mb-2"},"Descrizione",-1),Fe={class:"d-flex flex-column mb-7 fv-row"},Oe=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Tipologia profilo")],-1),qe=e("option",{value:""},"Seleziona la tipologia del profilo...",-1),Re=["value"],je={class:"d-flex flex-column mb-7 fv-row"},Ke=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Fornitore")],-1),We=e("option",{value:""},"Seleziona il fornitore...",-1),Qe=["value"],Ge={class:"fv-row mb-7"},He=e("label",{class:"fs-6 fw-semobold mb-2"},"Unità di misura",-1),Ze={class:"fv-row mb-7"},Je=e("label",{class:"fs-6 fw-semobold mb-2"},"Prezzo",-1),Xe={class:"fw-bold fs-3 rotate collapsible mb-7","data-bs-toggle":"collapse",href:"#kt_modal_add_billing_info",role:"button","aria-expanded":"false","aria-controls":"kt_view_details"},Ye={class:"ms-2 rotate-180"},eo={id:"kt_modal_add_billing_info",class:"collapse show"},oo={class:"fv-row mb-7"},to=e("label",{class:"fs-6 fw-semobold mb-2"},"Quantità per confezione",-1),ao={class:"fv-row mb-7"},so=e("label",{class:"fs-6 fw-semobold mb-2"},"Giacenza minima",-1),lo={class:"fv-row mb-7"},no=e("label",{class:"fs-6 fw-semobold mb-2"},"Tempistiche di consegna",-1),io={class:"d-flex flex-column mb-7 fv-row"},ro=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Tipologia consegna")],-1),co=e("option",{value:""},"Seleziona la modalità di consegna...",-1),mo=["value"],uo={class:"modal-footer flex-center"},fo=e("button",{type:"reset",id:"kt_modal_add_cancel",class:"btn btn-light me-3"}," Scarta ",-1),po=["data-kt-indicator"],bo={key:0,class:"indicator-label"},vo={key:1,class:"indicator-progress"},_o=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function ho(o,a,d,_,p,c){const l=S("KTIcon"),u=S("el-form");return n(),i("div",De,[e("div",ke,[e("div",xe,[e("div",Ce,[Te,e("div",ze,[f(l,{"icon-name":"cross","icon-class":"fs-1"})])]),f(u,{onSubmit:a[12]||(a[12]=M(t=>o.submit(),["prevent"])),model:o.formData,rules:o.rules,ref:"formRef"},{default:w(()=>[e("div",Ae,[e("div",Ie,[e("div",Pe,[Ee,m(e("input",{class:"form-control","onUpdate:modelValue":a[0]||(a[0]=t=>o.formData.Code=t),type:"text",placeholder:"Codice..."},null,512),[[h,o.formData.Code]])]),e("div",Be,[Ne,m(e("input",{class:"form-control","onUpdate:modelValue":a[1]||(a[1]=t=>o.formData.SupplierArticleCode=t),type:"text",placeholder:"Codice articolo fornitore..."},null,512),[[h,o.formData.SupplierArticleCode]])]),e("div",Ue,[Me,m(e("input",{class:"form-control","onUpdate:modelValue":a[2]||(a[2]=t=>o.formData.Name=t),type:"text",placeholder:"Nome..."},null,512),[[h,o.formData.Name]])]),e("div",Ve,[Le,m(e("textarea",{class:"form-control","onUpdate:modelValue":a[3]||(a[3]=t=>o.formData.Description=t),type:"text",placeholder:"Descrizione..."},null,512),[[h,o.formData.Description]])]),e("div",Fe,[Oe,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[4]||(a[4]=t=>o.formData.ProfileType=t)},[qe,(n(!0),i(k,null,T(o.ProfileTypes,t=>(n(),i("option",{key:t.id,value:t.name},y(t.name),9,Re))),128))],512),[[x,o.formData.ProfileType]])]),e("div",je,[Ke,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[5]||(a[5]=t=>o.formData.Supplier=t)},[We,(n(!0),i(k,null,T(o.Suppliers,t=>(n(),i("option",{key:t.id,value:t.name},y(t.name),9,Qe))),128))],512),[[x,o.formData.Supplier]])]),e("div",Ge,[He,m(e("input",{class:"form-control","onUpdate:modelValue":a[6]||(a[6]=t=>o.formData.UnitOfMeasure=t),type:"text",placeholder:"Unità di misura..."},null,512),[[h,o.formData.UnitOfMeasure]])]),e("div",Ze,[Je,m(e("input",{class:"form-control","onUpdate:modelValue":a[7]||(a[7]=t=>o.formData.Price=t),type:"number",placeholder:"Prezzo..."},null,512),[[h,o.formData.Price]])]),e("div",Xe,[b(" Informazioni logistiche "),e("span",Ye,[f(l,{"icon-name":"down","icon-class":"fs-3"})])]),e("div",eo,[e("div",oo,[to,m(e("input",{class:"form-control","onUpdate:modelValue":a[8]||(a[8]=t=>o.formData.PackageQuantity=t),type:"text",placeholder:"Quantità per confezione..."},null,512),[[h,o.formData.PackageQuantity]])]),e("div",ao,[so,m(e("input",{class:"form-control","onUpdate:modelValue":a[9]||(a[9]=t=>o.formData.MinimumStock=t),type:"text",placeholder:"Giacenza minima..."},null,512),[[h,o.formData.MinimumStock]])]),e("div",lo,[no,m(e("input",{class:"form-control","onUpdate:modelValue":a[10]||(a[10]=t=>o.formData.DeliveryTimeframe=t),type:"text",placeholder:"Tempistiche di consegna..."},null,512),[[h,o.formData.DeliveryTimeframe]])]),e("div",io,[ro,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[11]||(a[11]=t=>o.formData.DeliveryType=t)},[co,(n(!0),i(k,null,T(o.DeliveryTypes,t=>(n(),i("option",{key:t.id,value:t.name},y(t.name),9,mo))),128))],512),[[x,o.formData.DeliveryType]])])])])]),e("div",uo,[fo,e("button",{"data-kt-indicator":o.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[o.loading?A("",!0):(n(),i("span",bo,[b(" Invia "),f(l,{"icon-name":"arrow-right","icon-class":"fs-2 me-2 me-0"})])),o.loading?(n(),i("span",vo,[b(" Attendere... "),_o])):A("",!0)],8,po)])]),_:1},8,["model","rules"])])])],512)}const go=B(Se,[["render",ho]]),yo=P({name:"profiles-list",components:{Datatable:F,ExportProfilesModal:we,AddProfileModal:go,Loading:O},setup(){let o=r(!0);const a=r([{columnName:"Codice",columnLabel:"code",sortEnabled:!0,columnWidth:175},{columnName:"Nome",columnLabel:"name",sortEnabled:!0,columnWidth:230},{columnName:"Prezzo",columnLabel:"price",sortEnabled:!0,columnWidth:175},{columnName:"Descrizione",columnLabel:"description",sortEnabled:!0,columnWidth:175},{columnName:"Azioni",columnLabel:"actions",sortEnabled:!1,columnWidth:135}]),d=r([]);let _=r([]);async function p(s){_.value=await H(s),o.value=!1}V(()=>{o.value=!0,p("")});const c=()=>{d.value.forEach(s=>{l(s)}),d.value.length=0},l=s=>{o.value=!0,E.post(`Profiles/Delete?id=${s}`,{}).then(()=>{p("")}).catch(({response:C})=>{console.log(C)})},u=r("");return{tableData:_,tableHeader:a,deleteItem:l,search:u,searchItems:()=>{p(u.value),R.reinitialization()},selectedIds:d,deleteFewItems:c,sort:s=>{const C=s.order==="asc";s.label&&G(_.value,s.label,{reverse:C})},onItemSelect:s=>{d.value=s},getAssetPath:I,loading:o,getItems:p}}}),$o={class:"card"},wo={class:"card-header border-0 pt-6"},So={class:"card-title"},Do={class:"d-flex align-items-center position-relative my-1"},ko={class:"card-toolbar"},xo={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},Co={type:"button",class:"btn btn-light-primary me-3","data-bs-toggle":"modal","data-bs-target":"#kt_export_modal"},To={type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_add"},zo={key:1,class:"d-flex justify-content-end align-items-center","data-kt-customer-table-toolbar":"selected"},Ao={class:"fw-bold me-5"},Io={class:"me-2"},Po=e("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[e("div",{class:"fw-bold me-5"},[e("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Elimina Selezionati ")],-1),Eo={class:"card-body pt-0"},Bo=["onClick"];function No(o,a,d,_,p,c){const l=S("KTIcon"),u=S("router-link"),t=S("Datatable"),$=S("ExportProfilesModal"),v=S("AddProfileModal");return n(),i(k,null,[e("div",$o,[e("div",wo,[e("div",So,[e("div",Do,[f(l,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),m(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=s=>o.search=s),onInput:a[1]||(a[1]=s=>o.searchItems()),class:"form-control form-control-solid w-250px ps-15",placeholder:"Ricerca"},null,544),[[h,o.search]])])]),e("div",ko,[o.selectedIds.length===0?(n(),i("div",xo,[e("button",Co,[f(l,{"icon-name":"exit-up","icon-class":"fs-2"}),b(" Export ")]),e("button",To,[f(l,{"icon-name":"plus","icon-class":"fs-2"}),b(" Aggiungi profilo ")])])):(n(),i("div",zo,[e("div",Ao,[e("span",Io,y(o.selectedIds.length),1),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger",onClick:a[2]||(a[2]=s=>o.deleteFewItems())}," Elimina Selezionati ")])),Po])]),e("div",Eo,[f(t,{onOnSort:o.sort,onOnItemsSelect:o.onItemSelect,data:o.tableData,header:o.tableHeader,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!0,"checkbox-label":"id",loading:o.loading},{code:w(({row:s})=>[b(y(s.code),1)]),name:w(({row:s})=>[f(u,{to:{name:"update-profile",params:{id:s.id}},class:"text-gray-600 text-hover-primary mb-1"},{default:w(()=>[b(y(s.name),1)]),_:2},1032,["to"])]),price:w(({row:s})=>[b(y(s.price),1)]),description:w(({row:s})=>[b(y(s.description),1)]),actions:w(({row:s})=>[f(u,{to:{name:"update-profile",params:{id:s.id}},class:"btn btn-light-info me-1"},{default:w(()=>[b("Dettagli")]),_:2},1032,["to"]),e("button",{onClick:C=>o.deleteItem(s.id),class:"btn btn-light-danger me-1"},"Elimina",8,Bo)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading"])])]),f($),f(v,{onFormAddSubmitted:a[3]||(a[3]=s=>o.getItems(""))})],64)}const Qo=B(yo,[["render",No]]);export{Qo as default};
