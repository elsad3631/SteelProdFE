import{g as A}from"./assets-ce4ccef5.js";import{D as O,L as R}from"./KTDataTable-88696261.js";import{S as g}from"./sweetalert2-d38ee055.js";import{a as P}from"./alphabet-a5bbf61c.js";import{m as I,r,at as U,_ as E,p as $,q as n,w as i,x as e,K as p,C as w,a0 as d,F as k,y as x,z as y,a5 as C,L as b,A as z,au as V,o as F,a6 as _,M as q}from"./index-93335d48.js";import{h as K}from"./dom-8a591f7a.js";import{g as Q}from"./DeliveryTypes-dd2c53b6.js";import{g as j}from"./materialTypes-a75033aa.js";import{g as W}from"./suppliers-d1b63873.js";import{a as G}from"./index-39b333fd.js";import{g as H}from"./materials-1e134421.js";const Z=I({name:"export-accessories-modal",components:{},setup(){const t=r(null),a=r(!1),m=r({Filter:"",fromName:"A",toName:"Z",exportFormat:"excel"}),h=r({});return{formData:m,rules:h,submit:()=>{t.value&&t.value.validate(c=>{if(c){a.value=!0;let l=r(""),u=r("");if(m.value.exportFormat=="excel")l.value="ExportExcel",u.value=".xlsx";else if(m.value.exportFormat=="csv")l.value="ExportCsv",u.value=".csv";else{g.fire({text:"Attenzione, selezionare il formato del file.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),a.value=!1;return}U.get(`Materials/${l.value}?fromName=${m.value.fromName}&toName=${m.value.toName}`,"blob").then(o=>{const D=URL.createObjectURL(new Blob([o.data])),v=document.createElement("a");v.href=D,v.setAttribute("download","export materiali"+u.value),document.body.appendChild(v),v.click(),window.URL.revokeObjectURL(D),document.body.removeChild(v),a.value=!1,g.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})}).catch(({response:o})=>{console.log(o),a.value=!1,g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})})}else return g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})},formRef:t,loading:a,getAssetPath:A,alphabet:P}}});const J={class:"modal fade",id:"kt_export_modal",tabindex:"-1","aria-hidden":"true"},X={class:"modal-dialog modal-dialog-centered mw-650px"},Y={class:"modal-content"},ee={class:"modal-header"},te=e("h2",{class:"fw-bold"},"Export Materiali",-1),oe={id:"kt_export_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},ae={class:"modal-body scroll-y mx-5 mx-xl-15 my-7"},se={class:"fv-row mb-10"},le=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il range da lettera a lettera:",-1),ne={class:"input-group mb-5"},ie=["value"],re=e("span",{class:"input-group-text"},"-",-1),de=["value"],me={class:"fv-row mb-10"},ce=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il formato:",-1),ue=e("option",{value:"excel"},"Excel",-1),pe=e("option",{value:"csv"},"CSV",-1),fe=[ue,pe],be={class:"text-center"},ve=e("button",{type:"reset",id:"kt_export_cancel",class:"btn btn-light me-3"}," Scarta ",-1),_e=["data-kt-indicator"],he={key:0,class:"indicator-label"},ge={key:1,class:"indicator-progress"},ye=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function De(t,a,m,h,f,c){const l=$("KTIcon"),u=$("el-form");return n(),i("div",J,[e("div",X,[e("div",Y,[e("div",ee,[te,e("div",oe,[p(l,{"icon-name":"cross","icon-class":"fs-1"})])]),e("div",ae,[p(u,{onSubmit:a[3]||(a[3]=V(o=>t.submit(),["prevent"])),model:t.formData,rules:t.rules,ref:"formRef"},{default:w(()=>[e("div",se,[le,e("div",ne,[d(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[0]||(a[0]=o=>t.formData.fromName=o)},[(n(!0),i(k,null,x(t.alphabet,o=>(n(),i("option",{key:o.name,value:o.name},y(o.name),9,ie))),128))],512),[[C,t.formData.fromName]]),re,d(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[1]||(a[1]=o=>t.formData.toName=o)},[(n(!0),i(k,null,x(t.alphabet,o=>(n(),i("option",{key:o.name,value:o.name},y(o.name),9,de))),128))],512),[[C,t.formData.toName]])])]),e("div",me,[ce,d(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[2]||(a[2]=o=>t.formData.exportFormat=o)},fe,512),[[C,t.formData.exportFormat]])]),e("div",be,[ve,e("button",{"data-kt-indicator":t.loading?"on":null,type:"submit",class:"btn btn-lg btn-primary"},[t.loading?z("",!0):(n(),i("span",he,[b(" Invia "),p(l,{"icon-name":"arrow-right","icon-class":"fs-3 ms-2 me-0"})])),t.loading?(n(),i("span",ge,[b(" Attendere... "),ye])):z("",!0)],8,_e)])]),_:1},8,["model","rules"])])])])])}const we=E(Z,[["render",De]]),$e=I({name:"add-material-modal",components:{},setup(t,{emit:a}){const m=r(null),h=r(null),f=r(!1),c=r({Code:"",SupplierArticleCode:"",Name:"",Description:"",UnitOfMeasure:"",Function:"",SupplierId:0,Supplier:"",UnitPrice:0,PackagingQuantity:0,MinimumStock:0,Quantity:0,DeliveryTiming:"",DeliveryTypeId:0,DeliveryType:"",MaterialTypeId:0,MaterialType:"",LastDeliveryDate:new Date}),l=r({name:[{required:!0,message:"Inserire il nome",trigger:"change"}],Code:[{required:!0,message:"Inserire il codice interno",trigger:"change"}]}),u="Materials";let o=r([]),D=r([]),v=r([]);async function s(){try{o.value=await j(""),D.value=await W(""),v.value=await Q("")}catch(M){console.error(M)}}return F(()=>{s()}),{formData:c,rules:l,submit:()=>{const M=o.value.find(S=>S.name===c.value.MaterialType),N=D.value.find(S=>S.name===c.value.Supplier),B=v.value.find(S=>S.name===c.value.DeliveryType);if(m.value){if(M===void 0){g.fire({text:"Attenzione, selezionare la tipologia del materiale.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(N===void 0){g.fire({text:"Attenzione, selezionare il fornitore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(B===void 0){g.fire({text:"Attenzione, selezionare il metodo di pagamento.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}c.value.MaterialTypeId=M.id,c.value.SupplierId=N.id,c.value.DeliveryTypeId=B.id,console.log(c.value),m.value.validate(S=>{if(S)f.value=!0,U.post(`${u}/Create`,c.value).then(()=>{f.value=!1,g.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{K(h.value)}),a("formAddSubmitted",c.value)}).catch(({response:L})=>{console.log(L),f.value=!1,g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})});else return f.value=!1,g.fire({text:"Attenzione, non tutti i campi sono corretti.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})}},formRef:m,loading:f,addCustomerModalRef:h,getAssetPath:A,MaterialTypes:o,Suppliers:D,DeliveryTypes:v}}}),Se={class:"modal fade",id:"kt_modal_add",ref:"addCustomerModalRef",tabindex:"-1","aria-hidden":"true"},ke={class:"modal-dialog modal-dialog-centered mw-650px"},Ce={class:"modal-content"},Te={class:"modal-header",id:"kt_modal_add_header"},xe=e("h2",{class:"fw-bold"},"Aggiungi materiale",-1),Me={id:"kt_modal_add_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},ze={class:"modal-body py-10 px-lg-17"},Ae={class:"scroll-y me-n7 pe-7",id:"kt_modal_add_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_header","data-kt-scroll-wrappers":"#kt_modal_add_scroll","data-kt-scroll-offset":"300px"},Ie={class:"fv-row mb-7"},Ue=e("label",{class:"required fs-6 fw-semobold mb-2"},"Codice interno",-1),Ee={class:"fv-row mb-7"},Ne=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Codice articolo fornitore")],-1),Be={class:"fv-row mb-7"},Ve=e("label",{class:"required fs-6 fw-semobold mb-2"},"Nome",-1),Fe={class:"fv-row mb-7"},Le=e("label",{class:"fs-6 fw-semobold mb-2"},"Descrizione",-1),Oe={class:"d-flex flex-column mb-7 fv-row"},Re=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Tipologia materiale")],-1),Pe=e("option",{value:""},"Seleziona la tipologia dell'accessorio...",-1),qe=["value"],Ke={class:"d-flex flex-column mb-7 fv-row"},Qe=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Fornitore")],-1),je=e("option",{value:""},"Seleziona il fornitore...",-1),We=["value"],Ge={class:"fv-row mb-7"},He=e("label",{class:"fs-6 fw-semobold mb-2"},"Unità di misura",-1),Ze={class:"fv-row mb-7"},Je=e("label",{class:"fs-6 fw-semobold mb-2"},"Funzione",-1),Xe={class:"fv-row mb-7"},Ye=e("label",{class:"fs-6 fw-semobold mb-2"},"Prezzo unitario",-1),et={class:"fw-bold fs-3 rotate collapsible mb-7","data-bs-toggle":"collapse",href:"#kt_modal_add_billing_info",role:"button","aria-expanded":"false","aria-controls":"kt_view_details"},tt={class:"ms-2 rotate-180"},ot={id:"kt_modal_add_billing_info",class:"collapse show"},at={class:"fv-row mb-7"},st=e("label",{class:"fs-6 fw-semobold mb-2"},"Quantità per confezione",-1),lt={class:"fv-row mb-7"},nt=e("label",{class:"fs-6 fw-semobold mb-2"},"Giacenza minima",-1),it={class:"fv-row mb-7"},rt=e("label",{class:"fs-6 fw-semobold mb-2"},"Tempistiche di consegna",-1),dt={class:"fv-row mb-7"},mt=e("label",{class:"fs-6 fw-semobold mb-2"},"Data ultima consegna",-1),ct={class:"d-flex flex-column mb-7 fv-row"},ut=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Tipologia consegna")],-1),pt=e("option",{value:""},"Seleziona la modalità di consegna...",-1),ft=["value"],bt={class:"modal-footer flex-center"},vt=e("button",{type:"reset",id:"kt_modal_add_cancel",class:"btn btn-light me-3"}," Scarta ",-1),_t=["data-kt-indicator"],ht={key:0,class:"indicator-label"},gt={key:1,class:"indicator-progress"},yt=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function Dt(t,a,m,h,f,c){const l=$("KTIcon"),u=$("el-form");return n(),i("div",Se,[e("div",ke,[e("div",Ce,[e("div",Te,[xe,e("div",Me,[p(l,{"icon-name":"cross","icon-class":"fs-1"})])]),p(u,{onSubmit:a[14]||(a[14]=V(o=>t.submit(),["prevent"])),model:t.formData,rules:t.rules,ref:"formRef"},{default:w(()=>[e("div",ze,[e("div",Ae,[e("div",Ie,[Ue,d(e("input",{class:"form-control","onUpdate:modelValue":a[0]||(a[0]=o=>t.formData.Code=o),type:"text",placeholder:"Codice interno..."},null,512),[[_,t.formData.Code]])]),e("div",Ee,[Ne,d(e("input",{class:"form-control","onUpdate:modelValue":a[1]||(a[1]=o=>t.formData.SupplierArticleCode=o),type:"text",placeholder:"Codice articolo fornitore..."},null,512),[[_,t.formData.SupplierArticleCode]])]),e("div",Be,[Ve,d(e("input",{class:"form-control","onUpdate:modelValue":a[2]||(a[2]=o=>t.formData.Name=o),type:"text",placeholder:"Nome..."},null,512),[[_,t.formData.Name]])]),e("div",Fe,[Le,d(e("textarea",{class:"form-control","onUpdate:modelValue":a[3]||(a[3]=o=>t.formData.Description=o),type:"text",placeholder:"Descrizione..."},null,512),[[_,t.formData.Description]])]),e("div",Oe,[Re,d(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[4]||(a[4]=o=>t.formData.MaterialType=o)},[Pe,(n(!0),i(k,null,x(t.MaterialTypes,o=>(n(),i("option",{key:o.id,value:o.name},y(o.name),9,qe))),128))],512),[[C,t.formData.MaterialType]])]),e("div",Ke,[Qe,d(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[5]||(a[5]=o=>t.formData.Supplier=o)},[je,(n(!0),i(k,null,x(t.Suppliers,o=>(n(),i("option",{key:o.id,value:o.name},y(o.name),9,We))),128))],512),[[C,t.formData.Supplier]])]),e("div",Ge,[He,d(e("input",{class:"form-control","onUpdate:modelValue":a[6]||(a[6]=o=>t.formData.UnitOfMeasure=o),type:"text",placeholder:"Unità di misura..."},null,512),[[_,t.formData.UnitOfMeasure]])]),e("div",Ze,[Je,d(e("input",{class:"form-control","onUpdate:modelValue":a[7]||(a[7]=o=>t.formData.Function=o),type:"text",placeholder:"Funzione..."},null,512),[[_,t.formData.Function]])]),e("div",Xe,[Ye,d(e("input",{class:"form-control","onUpdate:modelValue":a[8]||(a[8]=o=>t.formData.UnitPrice=o),type:"number",placeholder:"Prezzo unitario..."},null,512),[[_,t.formData.UnitPrice]])]),e("div",et,[b(" Informazioni logistiche "),e("span",tt,[p(l,{"icon-name":"down","icon-class":"fs-3"})])]),e("div",ot,[e("div",at,[st,d(e("input",{class:"form-control","onUpdate:modelValue":a[9]||(a[9]=o=>t.formData.PackagingQuantity=o),type:"text",placeholder:"Quantità per confezione..."},null,512),[[_,t.formData.PackagingQuantity]])]),e("div",lt,[nt,d(e("input",{class:"form-control","onUpdate:modelValue":a[10]||(a[10]=o=>t.formData.MinimumStock=o),type:"text",placeholder:"Giacenza minima..."},null,512),[[_,t.formData.MinimumStock]])]),e("div",it,[rt,d(e("input",{class:"form-control","onUpdate:modelValue":a[11]||(a[11]=o=>t.formData.DeliveryTiming=o),type:"text",placeholder:"Tempistiche di consegna..."},null,512),[[_,t.formData.DeliveryTiming]])]),e("div",dt,[mt,d(e("input",{class:"form-control","onUpdate:modelValue":a[12]||(a[12]=o=>t.formData.LastDeliveryDate=o),type:"date",placeholder:"Data ultima consegna..."},null,512),[[_,t.formData.LastDeliveryDate]])]),e("div",ct,[ut,d(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":a[13]||(a[13]=o=>t.formData.DeliveryType=o)},[pt,(n(!0),i(k,null,x(t.DeliveryTypes,o=>(n(),i("option",{key:o.id,value:o.name},y(o.name),9,ft))),128))],512),[[C,t.formData.DeliveryType]])])])])]),e("div",bt,[vt,e("button",{"data-kt-indicator":t.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[t.loading?z("",!0):(n(),i("span",ht,[b(" Invia "),p(l,{"icon-name":"arrow-right","icon-class":"fs-2 me-2 me-0"})])),t.loading?(n(),i("span",gt,[b(" Attendere... "),yt])):z("",!0)],8,_t)])]),_:1},8,["model","rules"])])])],512)}const wt=E($e,[["render",Dt]]),$t=I({name:"materials-list",components:{Datatable:O,ExportMaterialsModal:we,AddMaterialModal:wt,Loading:R},setup(){let t=r(!0);const a=r([{columnName:"Codice",columnLabel:"code",sortEnabled:!0,columnWidth:175},{columnName:"Nome",columnLabel:"name",sortEnabled:!0,columnWidth:230},{columnName:"Prezzo",columnLabel:"price",sortEnabled:!0,columnWidth:175},{columnName:"Descrizione",columnLabel:"description",sortEnabled:!0,columnWidth:175},{columnName:"Azioni",columnLabel:"actions",sortEnabled:!1,columnWidth:135}]),m=r([]);let h=r([]);async function f(s){h.value=await H(s),t.value=!1}F(()=>{t.value=!0,f("")});const c=()=>{m.value.forEach(s=>{l(s)}),m.value.length=0},l=s=>{t.value=!0,U.post(`Materials/Delete?id=${s}`,{}).then(()=>{f("")}).catch(({response:T})=>{console.log(T)})},u=r("");return{tableData:h,tableHeader:a,deleteItem:l,search:u,searchItems:()=>{f(u.value),q.reinitialization()},selectedIds:m,deleteFewItems:c,sort:s=>{const T=s.order==="asc";s.label&&G(h.value,s.label,{reverse:T})},onItemSelect:s=>{m.value=s},getAssetPath:A,loading:t,getItems:f}}}),St={class:"card"},kt={class:"card-header border-0 pt-6"},Ct={class:"card-title"},Tt={class:"d-flex align-items-center position-relative my-1"},xt={class:"card-toolbar"},Mt={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},zt={type:"button",class:"btn btn-light-primary me-3","data-bs-toggle":"modal","data-bs-target":"#kt_export_modal"},At={type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_add"},It={key:1,class:"d-flex justify-content-end align-items-center","data-kt-customer-table-toolbar":"selected"},Ut={class:"fw-bold me-5"},Et={class:"me-2"},Nt=e("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[e("div",{class:"fw-bold me-5"},[e("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Elimina Selezionati ")],-1),Bt={class:"card-body pt-0"},Vt=["onClick"];function Ft(t,a,m,h,f,c){const l=$("KTIcon"),u=$("router-link"),o=$("Datatable"),D=$("ExportMaterialsModal"),v=$("AddMaterialModal");return n(),i(k,null,[e("div",St,[e("div",kt,[e("div",Ct,[e("div",Tt,[p(l,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),d(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=s=>t.search=s),onInput:a[1]||(a[1]=s=>t.searchItems()),class:"form-control form-control-solid w-250px ps-15",placeholder:"Ricerca"},null,544),[[_,t.search]])])]),e("div",xt,[t.selectedIds.length===0?(n(),i("div",Mt,[e("button",zt,[p(l,{"icon-name":"exit-up","icon-class":"fs-2"}),b(" Export ")]),e("button",At,[p(l,{"icon-name":"plus","icon-class":"fs-2"}),b(" Aggiungi materiale ")])])):(n(),i("div",It,[e("div",Ut,[e("span",Et,y(t.selectedIds.length),1),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger",onClick:a[2]||(a[2]=s=>t.deleteFewItems())}," Elimina Selezionati ")])),Nt])]),e("div",Bt,[p(o,{onOnSort:t.sort,onOnItemsSelect:t.onItemSelect,data:t.tableData,header:t.tableHeader,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!0,"checkbox-label":"id",loading:t.loading},{code:w(({row:s})=>[b(y(s.code),1)]),name:w(({row:s})=>[p(u,{to:{name:"update-material",params:{id:s.id}},class:"text-gray-600 text-hover-primary mb-1"},{default:w(()=>[b(y(s.name),1)]),_:2},1032,["to"])]),price:w(({row:s})=>[b(y(s.price),1)]),description:w(({row:s})=>[b(y(s.description),1)]),actions:w(({row:s})=>[p(u,{to:{name:"update-material",params:{id:s.id}},class:"btn btn-light-info me-1"},{default:w(()=>[b("Dettagli")]),_:2},1032,["to"]),e("button",{onClick:T=>t.deleteItem(s.id),class:"btn btn-light-danger me-1"},"Elimina",8,Vt)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading"])])]),p(D),p(v,{onFormAddSubmitted:a[3]||(a[3]=s=>t.getItems(""))})],64)}const Zt=E($t,[["render",Ft]]);export{Zt as default};
