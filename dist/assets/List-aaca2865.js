import{g as I}from"./assets-2a66e18f.js";import{D as O,L as q}from"./KTDataTable-b34f43d4.js";import{S as g}from"./sweetalert2-e92a9e07.js";import{a as R}from"./alphabet-a5bbf61c.js";import{j as E,r,an as B,_ as N,l as S,m as n,n as i,p as e,B as p,z as w,W as m,F as k,q as C,w as y,aj as A,O as b,x as z,am as V,o as L,a0 as h,M as P}from"./index-ac5572e4.js";import{h as j}from"./dom-668969a5.js";import{g as K}from"./accessoryTypes-96bcb43f.js";import{g as W}from"./suppliers-17d934fd.js";import{g as Q}from"./DeliveryTypes-4fbe9e42.js";import{a as G}from"./index-68cf51a8.js";import{g as H}from"./accessories-831a26ee.js";const Z=E({name:"export-accessories-modal",components:{},setup(){const o=r(null),s=r(!1),d=r({Filter:"",fromName:"A",toName:"Z",exportFormat:"excel"}),_=r({});return{formData:d,rules:_,submit:()=>{o.value&&o.value.validate(c=>{if(c){s.value=!0;let l=r(""),u=r("");if(d.value.exportFormat=="excel")l.value="ExportExcel",u.value=".xlsx";else if(d.value.exportFormat=="csv")l.value="ExportCsv",u.value=".csv";else{g.fire({text:"Attenzione, selezionare il formato del file.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),s.value=!1;return}B.get(`Accessories/${l.value}?fromName=${d.value.fromName}&toName=${d.value.toName}`,"blob").then(t=>{const $=URL.createObjectURL(new Blob([t.data])),v=document.createElement("a");v.href=$,v.setAttribute("download","export accessori"+u.value),document.body.appendChild(v),v.click(),window.URL.revokeObjectURL($),document.body.removeChild(v),s.value=!1,g.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})}).catch(({response:t})=>{console.log(t),s.value=!1,g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})})}else return g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})},formRef:o,loading:s,getAssetPath:I,alphabet:R}}});const J={class:"modal fade",id:"kt_export_modal",tabindex:"-1","aria-hidden":"true"},X={class:"modal-dialog modal-dialog-centered mw-650px"},Y={class:"modal-content"},ee={class:"modal-header"},oe=e("h2",{class:"fw-bold"},"Export Accessori",-1),te={id:"kt_export_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},se={class:"modal-body scroll-y mx-5 mx-xl-15 my-7"},ae={class:"fv-row mb-10"},le=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il range da lettera a lettera:",-1),ne={class:"input-group mb-5"},ie=["value"],re=e("span",{class:"input-group-text"},"-",-1),de=["value"],ce={class:"fv-row mb-10"},me=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il formato:",-1),ue=e("option",{value:"excel"},"Excel",-1),pe=e("option",{value:"csv"},"CSV",-1),fe=[ue,pe],be={class:"text-center"},ve=e("button",{type:"reset",id:"kt_export_cancel",class:"btn btn-light me-3"}," Scarta ",-1),_e=["data-kt-indicator"],he={key:0,class:"indicator-label"},ge={key:1,class:"indicator-progress"},ye=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function $e(o,s,d,_,f,c){const l=S("KTIcon"),u=S("el-form");return n(),i("div",J,[e("div",X,[e("div",Y,[e("div",ee,[oe,e("div",te,[p(l,{"icon-name":"cross","icon-class":"fs-1"})])]),e("div",se,[p(u,{onSubmit:s[3]||(s[3]=V(t=>o.submit(),["prevent"])),model:o.formData,rules:o.rules,ref:"formRef"},{default:w(()=>[e("div",ae,[le,e("div",ne,[m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":s[0]||(s[0]=t=>o.formData.fromName=t)},[(n(!0),i(k,null,C(o.alphabet,t=>(n(),i("option",{key:t.name,value:t.name},y(t.name),9,ie))),128))],512),[[A,o.formData.fromName]]),re,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":s[1]||(s[1]=t=>o.formData.toName=t)},[(n(!0),i(k,null,C(o.alphabet,t=>(n(),i("option",{key:t.name,value:t.name},y(t.name),9,de))),128))],512),[[A,o.formData.toName]])])]),e("div",ce,[me,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":s[2]||(s[2]=t=>o.formData.exportFormat=t)},fe,512),[[A,o.formData.exportFormat]])]),e("div",be,[ve,e("button",{"data-kt-indicator":o.loading?"on":null,type:"submit",class:"btn btn-lg btn-primary"},[o.loading?z("",!0):(n(),i("span",he,[b(" Invia "),p(l,{"icon-name":"arrow-right","icon-class":"fs-3 ms-2 me-0"})])),o.loading?(n(),i("span",ge,[b(" Attendere... "),ye])):z("",!0)],8,_e)])]),_:1},8,["model","rules"])])])])])}const we=N(Z,[["render",$e]]),Se=E({name:"add-accessory-modal",components:{},setup(o,{emit:s}){const d=r(null),_=r(null),f=r(!1),c=r({AccessoryType:"",AccessoryTypeId:0,Code:"",SupplierArticleCode:"",Name:"",Description:"",UnitOfMeasure:"",Supplier:"",SupplierId:0,Price:0,PackageQuantity:0,MinimumStock:0,DeliveryTimeframe:"",DeliveryType:"",DeliveryTypeId:0}),l=r({name:[{required:!0,message:"Inserire il nome",trigger:"change"}],Code:[{required:!0,message:"Inserire il codice",trigger:"change"}],AccessoryType:[{required:!0,message:"Selezionare la tipologia dell'accessorio",trigger:"change"}],Supplier:[{required:!0,message:"Selezionare il fornitore",trigger:"change"}]}),u="Accessories";let t=r([]),$=r([]),v=r([]);async function a(){try{t.value=await K(""),$.value=await W(""),v.value=await Q("")}catch(T){console.error(T)}}return L(()=>{a()}),{formData:c,rules:l,submit:()=>{const T=t.value.find(D=>D.name===c.value.AccessoryType),U=$.value.find(D=>D.name===c.value.Supplier),M=v.value.find(D=>D.name===c.value.DeliveryType);if(d.value){if(T===void 0){g.fire({text:"Attenzione, selezionare la tipologia dell'accessorio.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(U===void 0){g.fire({text:"Attenzione, selezionare il fornitore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}if(M===void 0){g.fire({text:"Attenzione, selezionare il metodo di pagamento.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}c.value.AccessoryTypeId=T.id,c.value.SupplierId=U.id,c.value.DeliveryTypeId=M.id,d.value.validate(D=>{if(D)f.value=!0,console.log(c.value),B.post(`${u}/Create`,c.value).then(()=>{f.value=!1,g.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{j(_.value)}),s("formAddSubmitted",c.value)}).catch(({response:F})=>{console.log(F),f.value=!1,g.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})});else return f.value=!1,g.fire({text:"Attenzione, non tutti i campi sono corretti.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})}},formRef:d,loading:f,addCustomerModalRef:_,getAssetPath:I,AccessoryTypes:t,Suppliers:$,DeliveryTypes:v}}}),De={class:"modal fade",id:"kt_modal_add",ref:"addCustomerModalRef",tabindex:"-1","aria-hidden":"true"},ke={class:"modal-dialog modal-dialog-centered mw-650px"},Ae={class:"modal-content"},xe={class:"modal-header",id:"kt_modal_add_header"},Ce=e("h2",{class:"fw-bold"},"Aggiungi accessorio",-1),Te={id:"kt_modal_add_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},ze={class:"modal-body py-10 px-lg-17"},Ie={class:"scroll-y me-n7 pe-7",id:"kt_modal_add_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_header","data-kt-scroll-wrappers":"#kt_modal_add_scroll","data-kt-scroll-offset":"300px"},Ee={class:"fv-row mb-7"},Be=e("label",{class:"required fs-6 fw-semobold mb-2"},"Codice",-1),Ne={class:"fv-row mb-7"},Ue=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Codice articolo fornitore")],-1),Me={class:"fv-row mb-7"},Ve=e("label",{class:"required fs-6 fw-semobold mb-2"},"Nome",-1),Le={class:"fv-row mb-7"},Fe=e("label",{class:"fs-6 fw-semobold mb-2"},"Descrizione",-1),Oe={class:"d-flex flex-column mb-7 fv-row"},qe=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Tipologia accessorio")],-1),Re=e("option",{value:""},"Seleziona la tipologia dell'accessorio...",-1),Pe=["value"],je={class:"d-flex flex-column mb-7 fv-row"},Ke=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Fornitore")],-1),We=e("option",{value:""},"Seleziona il fornitore...",-1),Qe=["value"],Ge={class:"fv-row mb-7"},He=e("label",{class:"fs-6 fw-semobold mb-2"},"Unità di misura",-1),Ze={class:"fv-row mb-7"},Je=e("label",{class:"fs-6 fw-semobold mb-2"},"Prezzo",-1),Xe={class:"fw-bold fs-3 rotate collapsible mb-7","data-bs-toggle":"collapse",href:"#kt_modal_add_billing_info",role:"button","aria-expanded":"false","aria-controls":"kt_view_details"},Ye={class:"ms-2 rotate-180"},eo={id:"kt_modal_add_billing_info",class:"collapse show"},oo={class:"fv-row mb-7"},to=e("label",{class:"fs-6 fw-semobold mb-2"},"Quantità per confezione",-1),so={class:"fv-row mb-7"},ao=e("label",{class:"fs-6 fw-semobold mb-2"},"Giacenza minima",-1),lo={class:"fv-row mb-7"},no=e("label",{class:"fs-6 fw-semobold mb-2"},"Tempistiche di consegna",-1),io={class:"d-flex flex-column mb-7 fv-row"},ro=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Tipologia consegna")],-1),co=e("option",{value:""},"Seleziona la modalità di consegna...",-1),mo=["value"],uo={class:"modal-footer flex-center"},po=e("button",{type:"reset",id:"kt_modal_add_cancel",class:"btn btn-light me-3"}," Scarta ",-1),fo=["data-kt-indicator"],bo={key:0,class:"indicator-label"},vo={key:1,class:"indicator-progress"},_o=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function ho(o,s,d,_,f,c){const l=S("KTIcon"),u=S("el-form");return n(),i("div",De,[e("div",ke,[e("div",Ae,[e("div",xe,[Ce,e("div",Te,[p(l,{"icon-name":"cross","icon-class":"fs-1"})])]),p(u,{onSubmit:s[12]||(s[12]=V(t=>o.submit(),["prevent"])),model:o.formData,rules:o.rules,ref:"formRef"},{default:w(()=>[e("div",ze,[e("div",Ie,[e("div",Ee,[Be,m(e("input",{class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>o.formData.Code=t),type:"text",placeholder:"Codice..."},null,512),[[h,o.formData.Code]])]),e("div",Ne,[Ue,m(e("input",{class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>o.formData.SupplierArticleCode=t),type:"text",placeholder:"Codice articolo fornitore..."},null,512),[[h,o.formData.SupplierArticleCode]])]),e("div",Me,[Ve,m(e("input",{class:"form-control","onUpdate:modelValue":s[2]||(s[2]=t=>o.formData.Name=t),type:"text",placeholder:"Nome..."},null,512),[[h,o.formData.Name]])]),e("div",Le,[Fe,m(e("textarea",{class:"form-control","onUpdate:modelValue":s[3]||(s[3]=t=>o.formData.Description=t),type:"text",placeholder:"Descrizione..."},null,512),[[h,o.formData.Description]])]),e("div",Oe,[qe,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":s[4]||(s[4]=t=>o.formData.AccessoryType=t)},[Re,(n(!0),i(k,null,C(o.AccessoryTypes,t=>(n(),i("option",{key:t.id,value:t.name},y(t.name),9,Pe))),128))],512),[[A,o.formData.AccessoryType]])]),e("div",je,[Ke,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":s[5]||(s[5]=t=>o.formData.Supplier=t)},[We,(n(!0),i(k,null,C(o.Suppliers,t=>(n(),i("option",{key:t.id,value:t.name},y(t.name),9,Qe))),128))],512),[[A,o.formData.Supplier]])]),e("div",Ge,[He,m(e("input",{class:"form-control","onUpdate:modelValue":s[6]||(s[6]=t=>o.formData.UnitOfMeasure=t),type:"text",placeholder:"Unità di misura..."},null,512),[[h,o.formData.UnitOfMeasure]])]),e("div",Ze,[Je,m(e("input",{class:"form-control","onUpdate:modelValue":s[7]||(s[7]=t=>o.formData.Price=t),type:"number",placeholder:"Prezzo..."},null,512),[[h,o.formData.Price]])]),e("div",Xe,[b(" Informazioni logistiche "),e("span",Ye,[p(l,{"icon-name":"down","icon-class":"fs-3"})])]),e("div",eo,[e("div",oo,[to,m(e("input",{class:"form-control","onUpdate:modelValue":s[8]||(s[8]=t=>o.formData.PackageQuantity=t),type:"text",placeholder:"Quantità per confezione..."},null,512),[[h,o.formData.PackageQuantity]])]),e("div",so,[ao,m(e("input",{class:"form-control","onUpdate:modelValue":s[9]||(s[9]=t=>o.formData.MinimumStock=t),type:"text",placeholder:"Giacenza minima..."},null,512),[[h,o.formData.MinimumStock]])]),e("div",lo,[no,m(e("input",{class:"form-control","onUpdate:modelValue":s[10]||(s[10]=t=>o.formData.DeliveryTimeframe=t),type:"text",placeholder:"Tempistiche di consegna..."},null,512),[[h,o.formData.DeliveryTimeframe]])]),e("div",io,[ro,m(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":s[11]||(s[11]=t=>o.formData.DeliveryType=t)},[co,(n(!0),i(k,null,C(o.DeliveryTypes,t=>(n(),i("option",{key:t.id,value:t.name},y(t.name),9,mo))),128))],512),[[A,o.formData.DeliveryType]])])])])]),e("div",uo,[po,e("button",{"data-kt-indicator":o.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[o.loading?z("",!0):(n(),i("span",bo,[b(" Invia "),p(l,{"icon-name":"arrow-right","icon-class":"fs-2 me-2 me-0"})])),o.loading?(n(),i("span",vo,[b(" Attendere... "),_o])):z("",!0)],8,fo)])]),_:1},8,["model","rules"])])])],512)}const go=N(Se,[["render",ho]]),yo=E({name:"accessories-list",components:{Datatable:O,ExportAccessoriesModal:we,AddAccessoryModal:go,Loading:q},setup(){let o=r(!0);const s=r([{columnName:"Codice",columnLabel:"code",sortEnabled:!0,columnWidth:175},{columnName:"Nome",columnLabel:"name",sortEnabled:!0,columnWidth:230},{columnName:"Prezzo",columnLabel:"price",sortEnabled:!0,columnWidth:175},{columnName:"Descrizione",columnLabel:"description",sortEnabled:!0,columnWidth:175},{columnName:"Azioni",columnLabel:"actions",sortEnabled:!1,columnWidth:135}]),d=r([]);let _=r([]);async function f(a){_.value=await H(a),o.value=!1}L(()=>{o.value=!0,f("")});const c=()=>{d.value.forEach(a=>{l(a)}),d.value.length=0},l=a=>{o.value=!0,B.post(`Accessories/Delete?id=${a}`,{}).then(()=>{f("")}).catch(({response:x})=>{console.log(x)})},u=r("");return{tableData:_,tableHeader:s,deleteItem:l,search:u,searchItems:()=>{f(u.value),P.reinitialization()},selectedIds:d,deleteFewItems:c,sort:a=>{const x=a.order==="asc";a.label&&G(_.value,a.label,{reverse:x})},onItemSelect:a=>{d.value=a},getAssetPath:I,loading:o,getItems:f}}}),$o={class:"card"},wo={class:"card-header border-0 pt-6"},So={class:"card-title"},Do={class:"d-flex align-items-center position-relative my-1"},ko={class:"card-toolbar"},Ao={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},xo={type:"button",class:"btn btn-light-primary me-3","data-bs-toggle":"modal","data-bs-target":"#kt_export_modal"},Co={type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_add"},To={key:1,class:"d-flex justify-content-end align-items-center","data-kt-customer-table-toolbar":"selected"},zo={class:"fw-bold me-5"},Io={class:"me-2"},Eo=e("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[e("div",{class:"fw-bold me-5"},[e("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Elimina Selezionati ")],-1),Bo={class:"card-body pt-0"},No=["onClick"];function Uo(o,s,d,_,f,c){const l=S("KTIcon"),u=S("router-link"),t=S("Datatable"),$=S("ExportAccessoriesModal"),v=S("AddAccessoryModal");return n(),i(k,null,[e("div",$o,[e("div",wo,[e("div",So,[e("div",Do,[p(l,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),m(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>o.search=a),onInput:s[1]||(s[1]=a=>o.searchItems()),class:"form-control form-control-solid w-250px ps-15",placeholder:"Ricerca"},null,544),[[h,o.search]])])]),e("div",ko,[o.selectedIds.length===0?(n(),i("div",Ao,[e("button",xo,[p(l,{"icon-name":"exit-up","icon-class":"fs-2"}),b(" Export ")]),e("button",Co,[p(l,{"icon-name":"plus","icon-class":"fs-2"}),b(" Aggiungi accessorio ")])])):(n(),i("div",To,[e("div",zo,[e("span",Io,y(o.selectedIds.length),1),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger",onClick:s[2]||(s[2]=a=>o.deleteFewItems())}," Elimina Selezionati ")])),Eo])]),e("div",Bo,[p(t,{onOnSort:o.sort,onOnItemsSelect:o.onItemSelect,data:o.tableData,header:o.tableHeader,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!0,"checkbox-label":"id",loading:o.loading},{code:w(({row:a})=>[b(y(a.code),1)]),name:w(({row:a})=>[p(u,{to:{name:"update-accessory",params:{id:a.id}},class:"text-gray-600 text-hover-primary mb-1"},{default:w(()=>[b(y(a.name),1)]),_:2},1032,["to"])]),price:w(({row:a})=>[b(y(a.price),1)]),description:w(({row:a})=>[b(y(a.description),1)]),actions:w(({row:a})=>[p(u,{to:{name:"update-accessory",params:{id:a.id}},class:"btn btn-light-info me-1"},{default:w(()=>[b("Dettagli")]),_:2},1032,["to"]),e("button",{onClick:x=>o.deleteItem(a.id),class:"btn btn-light-danger me-1"},"Elimina",8,No)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading"])])]),p($),p(v,{onFormAddSubmitted:s[3]||(s[3]=a=>o.getItems(""))})],64)}const Qo=N(yo,[["render",Uo]]);export{Qo as default};
