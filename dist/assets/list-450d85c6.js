import{g as I}from"./assets-0fb52c34.js";import{D as B,L as F}from"./KTDataTable-be20d7ae.js";import{S}from"./sweetalert2-86394131.js";import{a as M}from"./alphabet-a5bbf61c.js";import{m as N,r as n,av as z,_ as A,p as y,q as d,w as m,x as e,K as p,C as f,a0 as k,F as w,y as D,z as b,a5 as $,L as u,A as E,aw as T,o as R,ac as U,M as V,a6 as q}from"./index-6e218937.js";import{a as O}from"./index-9afe0745.js";const j=N({name:"export-stock-modal",components:{},setup(){const t=n(null),o=n(!1),l=n({Filter:"",fromName:"A",toName:"Z",exportFormat:"excel"}),_=n({});return{formData:l,rules:_,submit:()=>{t.value&&t.value.validate(v=>{if(v){o.value=!0;let r=n(""),i=n("");if(l.value.exportFormat=="excel")r.value="StockExportExcel",i.value=".xlsx";else if(l.value.exportFormat=="csv")r.value="StockExportCsv",i.value=".csv";else{S.fire({text:"Attenzione, selezionare il formato del file.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),o.value=!1;return}z.get(`GoodReceipt/${r.value}?fromName=${l.value.fromName}&toName=${l.value.toName}`,"blob").then(s=>{const h=URL.createObjectURL(new Blob([s.data])),a=document.createElement("a");a.href=h,a.setAttribute("download","export entrata merci"+i.value),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(h),document.body.removeChild(a),o.value=!1,S.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})}).catch(({response:s})=>{console.log(s),o.value=!1,S.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})})}else return S.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})},formRef:t,loading:o,getAssetPath:I,alphabet:M}}});const K={class:"modal fade",id:"kt_export_modal",tabindex:"-1","aria-hidden":"true"},W={class:"modal-dialog modal-dialog-centered mw-650px"},G={class:"modal-content"},P={class:"modal-header"},H=e("h2",{class:"fw-bold"},"Export magazzino",-1),Q={id:"kt_export_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},Z={class:"modal-body scroll-y mx-5 mx-xl-15 my-7"},J={class:"fv-row mb-10"},X=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il range da lettera a lettera:",-1),Y={class:"input-group mb-5"},ee=["value"],te=e("span",{class:"input-group-text"},"-",-1),oe=["value"],ae={class:"fv-row mb-10"},se=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il formato:",-1),ne=e("option",{value:"excel"},"Excel",-1),le=e("option",{value:"csv"},"CSV",-1),re=[ne,le],ie={class:"text-center"},ce=e("button",{type:"reset",id:"kt_export_cancel",class:"btn btn-light me-3"}," Scarta ",-1),de=["data-kt-indicator"],me={key:0,class:"indicator-label"},ue={key:1,class:"indicator-progress"},pe=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function fe(t,o,l,_,x,v){const r=y("KTIcon"),i=y("el-form");return d(),m("div",K,[e("div",W,[e("div",G,[e("div",P,[H,e("div",Q,[p(r,{"icon-name":"cross","icon-class":"fs-1"})])]),e("div",Z,[p(i,{onSubmit:o[3]||(o[3]=T(s=>t.submit(),["prevent"])),model:t.formData,rules:t.rules,ref:"formRef"},{default:f(()=>[e("div",J,[X,e("div",Y,[k(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":o[0]||(o[0]=s=>t.formData.fromName=s)},[(d(!0),m(w,null,D(t.alphabet,s=>(d(),m("option",{key:s.name,value:s.name},b(s.name),9,ee))),128))],512),[[$,t.formData.fromName]]),te,k(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":o[1]||(o[1]=s=>t.formData.toName=s)},[(d(!0),m(w,null,D(t.alphabet,s=>(d(),m("option",{key:s.name,value:s.name},b(s.name),9,oe))),128))],512),[[$,t.formData.toName]])])]),e("div",ae,[se,k(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":o[2]||(o[2]=s=>t.formData.exportFormat=s)},re,512),[[$,t.formData.exportFormat]])]),e("div",ie,[ce,e("button",{"data-kt-indicator":t.loading?"on":null,type:"submit",class:"btn btn-lg btn-primary"},[t.loading?E("",!0):(d(),m("span",me,[u(" Invia "),p(r,{"icon-name":"arrow-right","icon-class":"fs-3 ms-2 me-0"})])),t.loading?(d(),m("span",ue,[u(" Attendere... "),pe])):E("",!0)],8,de)])]),_:1},8,["model","rules"])])])])])}const be=A(j,[["render",fe]]),_e=(t,o)=>z.get(`GoodReceipt/GetStocks?currentPage=0&filterRequest=${t}&typeFilter=${o}`,"").then(({data:l})=>l.data).catch(({response:l})=>(console.log(l),[])),ve=N({name:"goods-receipt-list",components:{Datatable:B,ExportStockModal:be,Loading:F},setup(){let t=n(!0),o=n(0),l=n(0),_=n(0);const x=n([{columnName:"Codice",columnLabel:"code",sortEnabled:!0,columnWidth:175},{columnName:"Lotto",columnLabel:"name",sortEnabled:!0,columnWidth:230},{columnName:"Quantità",columnLabel:"quantity",sortEnabled:!0,columnWidth:175},{columnName:"Ultima spedizione",columnLabel:"date",sortEnabled:!0,columnWidth:175},{columnName:"Azioni",columnLabel:"actions",sortEnabled:!1,columnWidth:135}]),v=n([]);let r=n([]);async function i(c,g){r.value=await _e(c,g),t.value=!1}R(()=>{t.value=!0,i("",o.value)}),U(o,async(c,g)=>{i("",c)});const s=n(""),h=()=>{i(s.value,o.value),V.reinitialization()},a=c=>{const g=c.order==="asc";c.label&&O(r.value,c.label,{reverse:g})},C=c=>{v.value=c};function L(c,g){l.value=c,_.value=g}return{tableData:r,tableHeader:x,search:s,searchItems:h,selectedIds:v,typeFilter:o,selectStock:L,sort:a,onItemSelect:C,getAssetPath:I,loading:t,getItems:i}}}),he={class:"card"},ge={class:"card-header border-0 pt-6"},ye={class:"card-title"},ke={class:"d-flex align-items-center position-relative my-1"},xe=e("option",{value:"0"},"Accessorio",-1),Se=e("option",{value:"1"},"Profilo",-1),$e=e("option",{value:"2"},"Materiale",-1),we=[xe,Se,$e],Ce={class:"card-toolbar"},De={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},Ee={type:"button",class:"btn btn-light-primary me-3","data-bs-toggle":"modal","data-bs-target":"#kt_export_modal"},Ie={key:1,class:"d-flex justify-content-end align-items-center","data-kt-customer-table-toolbar":"selected"},Ne={class:"fw-bold me-5"},ze={class:"me-2"},Ae=e("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[e("div",{class:"fw-bold me-5"},[e("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),u("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Elimina Selezionati ")],-1),Le={class:"card-body pt-0"},Be=["onClick"];function Fe(t,o,l,_,x,v){const r=y("KTIcon"),i=y("router-link"),s=y("Datatable"),h=y("ExportStockModal");return d(),m(w,null,[e("div",he,[e("div",ge,[e("div",ye,[e("div",ke,[p(r,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),k(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),onInput:o[1]||(o[1]=a=>t.searchItems()),class:"form-control form-control-solid w-250px ps-15",placeholder:"Ricerca"},null,544),[[q,t.search]]),k(e("select",{as:"select",class:"form-select fw-semobold","onUpdate:modelValue":o[2]||(o[2]=a=>t.typeFilter=a)},we,512),[[$,t.typeFilter]])])]),e("div",Ce,[t.selectedIds.length===0?(d(),m("div",De,[e("button",Ee,[p(r,{"icon-name":"exit-up","icon-class":"fs-2"}),u(" Export ")])])):(d(),m("div",Ie,[e("div",Ne,[e("span",ze,b(t.selectedIds.length),1),u("Selezionati ")])])),Ae])]),e("div",Le,[p(s,{onOnSort:t.sort,onOnItemsSelect:t.onItemSelect,data:t.tableData,header:t.tableHeader,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!0,"checkbox-label":"id",loading:t.loading},{code:f(({row:a})=>[u(b(a.code),1)]),name:f(({row:a})=>[p(i,{to:{name:"update-good-receipt",params:{id:a.id}},class:"text-gray-600 text-hover-primary mb-1"},{default:f(()=>[u(b(a.name),1)]),_:2},1032,["to"])]),quantity:f(({row:a})=>[u(b(a.quantity),1)]),date:f(({row:a})=>[u(b(new Date(a.lastDeliveryDate).toLocaleDateString("it-IT")),1)]),actions:f(({row:a})=>[e("a",{href:"javascript:void(0)",onClick:C=>t.selectStock(a.id,a.quantity),class:"btn btn-light-info me-1"},"Modifica quantità",8,Be)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading"])])]),p(h)],64)}const Oe=A(ve,[["render",Fe]]);export{Oe as default};
