import{g as V}from"./assets-0fb52c34.js";import{D as z,L as B}from"./KTDataTable-be20d7ae.js";import{S as $}from"./sweetalert2-86394131.js";import{a as F}from"./alphabet-a5bbf61c.js";import{m as x,r as d,av as N,_ as P,p as y,q as u,w as f,x as e,K as c,C as g,a0 as l,F as S,y as I,z as C,a5 as k,L as b,A,aw as U,o as E,a6 as n,M}from"./index-6e218937.js";import{h as R}from"./dom-52183280.js";import{g as L}from"./paymentTypes-35872797.js";import{a as q}from"./index-9afe0745.js";import{g as O}from"./suppliers-6abf7701.js";const K=x({name:"export-suppliers-modal",components:{},setup(){const o=d(null),t=d(!1),i=d({Filter:"",fromName:"A",toName:"Z",exportFormat:"excel"}),_=d({});return{formData:i,rules:_,submit:()=>{o.value&&o.value.validate(v=>{if(v){t.value=!0;let r=d(""),m=d("");if(i.value.exportFormat=="excel")r.value="ExportExcel",m.value=".xlsx";else if(i.value.exportFormat=="csv")r.value="ExportCsv",m.value=".csv";else{$.fire({text:"Attenzione, selezionare il formato del file.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),t.value=!1;return}N.get(`Suppliers/${r.value}?fromName=${i.value.fromName}&toName=${i.value.toName}`,"blob").then(s=>{const D=URL.createObjectURL(new Blob([s.data])),h=document.createElement("a");h.href=D,h.setAttribute("download","export fornitori"+m.value),document.body.appendChild(h),h.click(),window.URL.revokeObjectURL(D),document.body.removeChild(h),t.value=!1,$.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})}).catch(({response:s})=>{console.log(s),t.value=!1,$.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})})}else return $.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})},formRef:o,loading:t,getAssetPath:V,alphabet:F}}});const j={class:"modal fade",id:"kt_export_modal",tabindex:"-1","aria-hidden":"true"},W={class:"modal-dialog modal-dialog-centered mw-650px"},Z={class:"modal-content"},H={class:"modal-header"},G=e("h2",{class:"fw-bold"},"Export Fornitori",-1),J={id:"kt_export_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},Q={class:"modal-body scroll-y mx-5 mx-xl-15 my-7"},X={class:"fv-row mb-10"},Y=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il range da lettera a lettera:",-1),ee={class:"input-group mb-5"},oe=["value"],te=e("span",{class:"input-group-text"},"-",-1),se=["value"],ae={class:"fv-row mb-10"},le=e("label",{class:"fs-5 fw-semobold form-label mb-5"},"Seleziona il formato:",-1),ne=e("option",{value:"excel"},"Excel",-1),re=e("option",{value:"csv"},"CSV",-1),ie=[ne,re],de={class:"text-center"},me=e("button",{type:"reset",id:"kt_export_cancel",class:"btn btn-light me-3"}," Scarta ",-1),ce=["data-kt-indicator"],ue={key:0,class:"indicator-label"},fe={key:1,class:"indicator-progress"},pe=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function be(o,t,i,_,p,v){const r=y("KTIcon"),m=y("el-form");return u(),f("div",j,[e("div",W,[e("div",Z,[e("div",H,[G,e("div",J,[c(r,{"icon-name":"cross","icon-class":"fs-1"})])]),e("div",Q,[c(m,{onSubmit:t[3]||(t[3]=U(s=>o.submit(),["prevent"])),model:o.formData,rules:o.rules,ref:"formRef"},{default:g(()=>[e("div",X,[Y,e("div",ee,[l(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":t[0]||(t[0]=s=>o.formData.fromName=s)},[(u(!0),f(S,null,I(o.alphabet,s=>(u(),f("option",{key:s.name,value:s.name},C(s.name),9,oe))),128))],512),[[k,o.formData.fromName]]),te,l(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":t[1]||(t[1]=s=>o.formData.toName=s)},[(u(!0),f(S,null,I(o.alphabet,s=>(u(),f("option",{key:s.name,value:s.name},C(s.name),9,se))),128))],512),[[k,o.formData.toName]])])]),e("div",ae,[le,l(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":t[2]||(t[2]=s=>o.formData.exportFormat=s)},ie,512),[[k,o.formData.exportFormat]])]),e("div",de,[me,e("button",{"data-kt-indicator":o.loading?"on":null,type:"submit",class:"btn btn-lg btn-primary"},[o.loading?A("",!0):(u(),f("span",ue,[b(" Invia "),c(r,{"icon-name":"arrow-right","icon-class":"fs-3 ms-2 me-0"})])),o.loading?(u(),f("span",fe,[b(" Attendere... "),pe])):A("",!0)],8,ce)])]),_:1},8,["model","rules"])])])])])}const ve=P(K,[["render",be]]),_e=x({name:"add-supplier-modal",components:{},setup(o,{emit:t}){const i=d(null),_=d(null),p=d(!1),v=d({Name:"",Code:"",UniqueCode:"",Address:"",ZipCode:"",City:"",Country:"",Province:"",VatNumber:"",FiscalCode:"",ContactPerson:"",Phone:0,Mobile:0,Email:"",Pec:"",Fax:"",ReferenceAgent:"",PaymentTypeId:0,PaymentType:"",BankDetails:"",Notes:""}),r=d({name:[{required:!0,message:"Inserire il nome",trigger:"change"}],Code:[{required:!0,message:"Inserire il codice",trigger:"change"}],PaymentType:[{required:!0,message:"Selezionare la modalità di pagamento",trigger:"change"}]}),m="Suppliers";let s=d([]);async function D(){try{s.value=await L("")}catch(a){console.error(a)}}return E(()=>{D()}),{formData:v,rules:r,submit:()=>{const a=s.value.find(w=>w.name===v.value.PaymentType);if(i.value){if(a===void 0){$.fire({text:"Attenzione, selezionare la modalità di pagamento.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}});return}v.value.PaymentTypeId=a.id,i.value.validate(w=>{if(w)p.value=!0,console.log(v.value),N.post(`${m}/Create`,v.value).then(()=>{p.value=!1,$.fire({text:"Operazione completata!",icon:"success",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{R(_.value)}),t("formAddSubmitted",v.value)}).catch(({response:T})=>{console.log(T),p.value=!1,$.fire({text:"Attenzione, si è verificato un errore.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}})});else return p.value=!1,$.fire({text:"Attenzione, non tutti i campi sono corretti.",icon:"error",buttonsStyling:!1,confirmButtonText:"Continua!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),!1})}},formRef:i,loading:p,addCustomerModalRef:_,getAssetPath:V,PaymentTypes:s}}}),he={class:"modal fade",id:"kt_modal_add",ref:"addCustomerModalRef",tabindex:"-1","aria-hidden":"true"},ge={class:"modal-dialog modal-dialog-centered mw-650px"},ye={class:"modal-content"},we={class:"modal-header",id:"kt_modal_add_header"},Ce=e("h2",{class:"fw-bold"},"Aggiungi fornitore",-1),$e={id:"kt_modal_add_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},De={class:"modal-body py-10 px-lg-17"},ke={class:"scroll-y me-n7 pe-7",id:"kt_modal_add_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_header","data-kt-scroll-wrappers":"#kt_modal_add_scroll","data-kt-scroll-offset":"300px"},Se={class:"fv-row mb-7"},Ae=e("label",{class:"required fs-6 fw-semobold mb-2"},"Codice",-1),Ie={class:"fv-row mb-7"},Ve=e("label",{class:"fs-6 fw-semobold mb-2"},"Codice univoco",-1),xe={class:"fv-row mb-7"},Ne=e("label",{class:"required fs-6 fw-semobold mb-2"},"Nome",-1),Pe={class:"fv-row mb-7"},Ue=e("label",{class:"fs-6 fw-semobold mb-2"},"Indirizzo",-1),Ee={class:"fv-row mb-7"},Te=e("label",{class:"fs-6 fw-semobold mb-2"},"P. IVA",-1),ze={class:"fv-row mb-7"},Be=e("label",{class:"fs-6 fw-semobold mb-2"},"Codice fiscale",-1),Fe={class:"fv-row mb-7"},Me=e("label",{class:"fs-6 fw-semobold mb-2"},"Referente",-1),Re={class:"fv-row mb-7"},Le=e("label",{class:"fs-6 fw-semobold mb-2"},"Telefono",-1),qe={class:"fv-row mb-7"},Oe=e("label",{class:"fs-6 fw-semobold mb-2"},"Cellulare",-1),Ke={class:"fv-row mb-7"},je=e("label",{class:"required fs-6 fw-semobold mb-2"},"Email",-1),We={class:"fv-row mb-7"},Ze=e("label",{class:"fs-6 fw-semobold mb-2"},"Pec",-1),He={class:"fv-row mb-7"},Ge=e("label",{class:"fs-6 fw-semobold mb-2"},"Agente di riferimento",-1),Je={class:"fv-row mb-7"},Qe=e("label",{class:"fs-6 fw-semobold mb-2"},"Coordinate bancarie",-1),Xe={class:"fv-row mb-7"},Ye=e("label",{class:"fs-6 fw-semobold mb-2"},"Note",-1),eo={class:"fw-bold fs-3 rotate collapsible mb-7","data-bs-toggle":"collapse",href:"#kt_modal_add_billing_info",role:"button","aria-expanded":"false","aria-controls":"kt_view_details"},oo={class:"ms-2 rotate-180"},to={id:"kt_modal_add_billing_info",class:"collapse show"},so={class:"fv-row mb-7"},ao=e("label",{class:"fs-6 fw-semobold mb-2"},"Codice postale",-1),lo={class:"fv-row mb-7"},no=e("label",{class:"fs-6 fw-semobold mb-2"},"Città",-1),ro={class:"fv-row mb-7"},io=e("label",{class:"fs-6 fw-semobold mb-2"},"Paese",-1),mo={class:"fv-row mb-7"},co=e("label",{class:"fs-6 fw-semobold mb-2"},"Provincia",-1),uo={class:"fv-row mb-7"},fo=e("label",{class:"fs-6 fw-semobold mb-2"},"Fax",-1),po={class:"d-flex flex-column mb-7 fv-row"},bo=e("label",{class:"fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Modalità di pagamento")],-1),vo=e("option",{value:""},"Seleziona la modalità di pagamento...",-1),_o=["value"],ho={class:"modal-footer flex-center"},go=e("button",{type:"reset",id:"kt_modal_add_cancel",class:"btn btn-light me-3"}," Scarta ",-1),yo=["data-kt-indicator"],wo={key:0,class:"indicator-label"},Co={key:1,class:"indicator-progress"},$o=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function Do(o,t,i,_,p,v){const r=y("KTIcon"),m=y("el-form");return u(),f("div",he,[e("div",ge,[e("div",ye,[e("div",we,[Ce,e("div",$e,[c(r,{"icon-name":"cross","icon-class":"fs-1"})])]),c(m,{onSubmit:t[20]||(t[20]=U(s=>o.submit(),["prevent"])),model:o.formData,rules:o.rules,ref:"formRef"},{default:g(()=>[e("div",De,[e("div",ke,[e("div",Se,[Ae,l(e("input",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=s=>o.formData.Code=s),type:"text",placeholder:"Codice..."},null,512),[[n,o.formData.Code]])]),e("div",Ie,[Ve,l(e("input",{class:"form-control","onUpdate:modelValue":t[1]||(t[1]=s=>o.formData.UniqueCode=s),type:"text",placeholder:"Codice univoco..."},null,512),[[n,o.formData.UniqueCode]])]),e("div",xe,[Ne,l(e("input",{class:"form-control","onUpdate:modelValue":t[2]||(t[2]=s=>o.formData.Name=s),type:"text",placeholder:"Nome..."},null,512),[[n,o.formData.Name]])]),e("div",Pe,[Ue,l(e("input",{class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>o.formData.Address=s),type:"text",placeholder:"Indirizzo..."},null,512),[[n,o.formData.Address]])]),e("div",Ee,[Te,l(e("input",{class:"form-control","onUpdate:modelValue":t[4]||(t[4]=s=>o.formData.VatNumber=s),type:"text",placeholder:"P. IVA..."},null,512),[[n,o.formData.VatNumber]])]),e("div",ze,[Be,l(e("input",{class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>o.formData.FiscalCode=s),type:"text",placeholder:"Codice fiscale..."},null,512),[[n,o.formData.FiscalCode]])]),e("div",Fe,[Me,l(e("input",{class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>o.formData.ContactPerson=s),type:"text",placeholder:"Referente..."},null,512),[[n,o.formData.ContactPerson]])]),e("div",Re,[Le,l(e("input",{class:"form-control","onUpdate:modelValue":t[7]||(t[7]=s=>o.formData.Phone=s),type:"number",placeholder:"Telefono..."},null,512),[[n,o.formData.Phone]])]),e("div",qe,[Oe,l(e("input",{class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>o.formData.Mobile=s),type:"number",placeholder:"Cellulare..."},null,512),[[n,o.formData.Mobile]])]),e("div",Ke,[je,l(e("input",{class:"form-control","onUpdate:modelValue":t[9]||(t[9]=s=>o.formData.Email=s),type:"email",placeholder:"Email..."},null,512),[[n,o.formData.Email]])]),e("div",We,[Ze,l(e("input",{class:"form-control","onUpdate:modelValue":t[10]||(t[10]=s=>o.formData.Pec=s),type:"email",placeholder:"Pec..."},null,512),[[n,o.formData.Pec]])]),e("div",He,[Ge,l(e("input",{class:"form-control","onUpdate:modelValue":t[11]||(t[11]=s=>o.formData.ReferenceAgent=s),type:"text",placeholder:"Agente di riferimento..."},null,512),[[n,o.formData.ReferenceAgent]])]),e("div",Je,[Qe,l(e("input",{class:"form-control","onUpdate:modelValue":t[12]||(t[12]=s=>o.formData.BankDetails=s),type:"text",placeholder:"Coordinate bancarie..."},null,512),[[n,o.formData.BankDetails]])]),e("div",Xe,[Ye,l(e("input",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=s=>o.formData.Notes=s),type:"text",placeholder:"Note..."},null,512),[[n,o.formData.Notes]])]),e("div",eo,[b(" Informazioni logistiche "),e("span",oo,[c(r,{"icon-name":"down","icon-class":"fs-3"})])]),e("div",to,[e("div",so,[ao,l(e("input",{class:"form-control","onUpdate:modelValue":t[14]||(t[14]=s=>o.formData.ZipCode=s),type:"text",placeholder:"Codice postale..."},null,512),[[n,o.formData.ZipCode]])]),e("div",lo,[no,l(e("input",{class:"form-control","onUpdate:modelValue":t[15]||(t[15]=s=>o.formData.City=s),type:"text",placeholder:"Città..."},null,512),[[n,o.formData.City]])]),e("div",ro,[io,l(e("input",{class:"form-control","onUpdate:modelValue":t[16]||(t[16]=s=>o.formData.Country=s),type:"text",placeholder:"Paese..."},null,512),[[n,o.formData.Country]])]),e("div",mo,[co,l(e("input",{class:"form-control","onUpdate:modelValue":t[17]||(t[17]=s=>o.formData.Province=s),type:"text",placeholder:"Provincia..."},null,512),[[n,o.formData.Province]])]),e("div",uo,[fo,l(e("input",{class:"form-control","onUpdate:modelValue":t[18]||(t[18]=s=>o.formData.Fax=s),type:"text",placeholder:"Fax..."},null,512),[[n,o.formData.Fax]])]),e("div",po,[bo,l(e("select",{class:"form-select","aria-label":"Select example","onUpdate:modelValue":t[19]||(t[19]=s=>o.formData.PaymentType=s)},[vo,(u(!0),f(S,null,I(o.PaymentTypes,s=>(u(),f("option",{key:s.id,value:s.name},C(s.name),9,_o))),128))],512),[[k,o.formData.PaymentType]])])])])]),e("div",ho,[go,e("button",{"data-kt-indicator":o.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[o.loading?A("",!0):(u(),f("span",wo,[b(" Invia "),c(r,{"icon-name":"arrow-right","icon-class":"fs-2 me-2 me-0"})])),o.loading?(u(),f("span",Co,[b(" Attendere... "),$o])):A("",!0)],8,yo)])]),_:1},8,["model","rules"])])])],512)}const ko=P(_e,[["render",Do]]),So=x({name:"suppliers-list",components:{Datatable:z,ExportSuppliersModal:ve,AddSupplierModal:ko,Loading:B},setup(){let o=d(!0);const t=d([{columnName:"Codice",columnLabel:"code",sortEnabled:!0,columnWidth:175},{columnName:"Nome",columnLabel:"name",sortEnabled:!0,columnWidth:230},{columnName:"Prezzo",columnLabel:"price",sortEnabled:!0,columnWidth:175},{columnName:"Descrizione",columnLabel:"description",sortEnabled:!0,columnWidth:175},{columnName:"Azioni",columnLabel:"actions",sortEnabled:!1,columnWidth:135}]),i=d([]);let _=d([]);async function p(a){_.value=await O(a),o.value=!1}E(()=>{o.value=!0,p("")});const v=()=>{i.value.forEach(a=>{r(a)}),i.value.length=0},r=a=>{o.value=!0,N.post(`Suppliers/Delete?id=${a}`,{}).then(()=>{p("")}).catch(({response:w})=>{console.log(w)})},m=d("");return{tableData:_,tableHeader:t,deleteItem:r,search:m,searchItems:()=>{p(m.value),M.reinitialization()},selectedIds:i,deleteFewItems:v,sort:a=>{const w=a.order==="asc";a.label&&q(_.value,a.label,{reverse:w})},onItemSelect:a=>{i.value=a},getAssetPath:V,loading:o,getItems:p}}}),Ao={class:"card"},Io={class:"card-header border-0 pt-6"},Vo={class:"card-title"},xo={class:"d-flex align-items-center position-relative my-1"},No={class:"card-toolbar"},Po={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},Uo={type:"button",class:"btn btn-light-primary me-3","data-bs-toggle":"modal","data-bs-target":"#kt_export_modal"},Eo={type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_add"},To={key:1,class:"d-flex justify-content-end align-items-center","data-kt-customer-table-toolbar":"selected"},zo={class:"fw-bold me-5"},Bo={class:"me-2"},Fo=e("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[e("div",{class:"fw-bold me-5"},[e("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Elimina Selezionati ")],-1),Mo={class:"card-body pt-0"},Ro=["onClick"];function Lo(o,t,i,_,p,v){const r=y("KTIcon"),m=y("router-link"),s=y("Datatable"),D=y("ExportSuppliersModal"),h=y("AddSupplierModal");return u(),f(S,null,[e("div",Ao,[e("div",Io,[e("div",Vo,[e("div",xo,[c(r,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),l(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.search=a),onInput:t[1]||(t[1]=a=>o.searchItems()),class:"form-control form-control-solid w-250px ps-15",placeholder:"Ricerca"},null,544),[[n,o.search]])])]),e("div",No,[o.selectedIds.length===0?(u(),f("div",Po,[e("button",Uo,[c(r,{"icon-name":"exit-up","icon-class":"fs-2"}),b(" Export ")]),e("button",Eo,[c(r,{"icon-name":"plus","icon-class":"fs-2"}),b(" Aggiungi fornitore ")])])):(u(),f("div",To,[e("div",zo,[e("span",Bo,C(o.selectedIds.length),1),b("Selezionati ")]),e("button",{type:"button",class:"btn btn-danger",onClick:t[2]||(t[2]=a=>o.deleteFewItems())}," Elimina Selezionati ")])),Fo])]),e("div",Mo,[c(s,{onOnSort:o.sort,onOnItemsSelect:o.onItemSelect,data:o.tableData,header:o.tableHeader,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!0,"checkbox-label":"id",loading:o.loading},{code:g(({row:a})=>[b(C(a.code),1)]),name:g(({row:a})=>[c(m,{to:{name:"update-supplier",params:{id:a.id}},class:"text-gray-600 text-hover-primary mb-1"},{default:g(()=>[b(C(a.name),1)]),_:2},1032,["to"])]),price:g(({row:a})=>[b(C(a.price),1)]),description:g(({row:a})=>[b(C(a.description),1)]),actions:g(({row:a})=>[c(m,{to:{name:"update-supplier",params:{id:a.id}},class:"btn btn-light-info me-1"},{default:g(()=>[b("Dettagli")]),_:2},1032,["to"]),e("button",{onClick:w=>o.deleteItem(a.id),class:"btn btn-light-danger me-1"},"Elimina",8,Ro)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading"])])]),c(D),c(h,{onFormAddSubmitted:t[3]||(t[3]=a=>o.getItems(""))})],64)}const Qo=P(So,[["render",Lo]]);export{Qo as default};
